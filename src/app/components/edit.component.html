<div class="edit-container" [class.active]="active">
  <div class="content flex-center">
    <h1 *ngIf="createNew">Add new</h1>
    <h1 *ngIf="!createNew">{{ part.title }}</h1>
    <div class="form">
      <div class="form-item" *ngIf="createNew">
        <label>Type</label>
        <select [(ngModel)]="part.partType" (change)="typeChanged()">
          <option [value]="t" *ngFor="let t of partTypes">{{ capitalizeFirstLetter(t) }}</option>
        </select>
      </div>

      <div class="form-item" *ngIf="isType('separator')">
        <label>Type</label>
        <select [(ngModel)]="part.name" (change)="separatorTypeChanged()">
          <option [value]="t.name" *ngFor="let t of separatorTypes">{{ t.name }}</option>
        </select>
      </div>

      <div class="form-item" *ngIf="isType('guided session')">
        <label>Type</label>
        <select [(ngModel)]="part.name" (change)="guidedSessionTypeChanged()">
          <option [value]="t.name" *ngFor="let t of guidedSessions">{{ t.name }}</option>
        </select>
      </div>

      <div class="form-item row" *ngIf="isType('mantra') && isType('metronome')">
        <label>Time based?</label>
        <input type="checkbox" [(ngModel)]="part.timeBased">
      </div>

      <div class="form-item" *ngIf="part.timeBased && !isType() && !isType('guided session') && !isType('polyphonic binaural beats')">
        <label>Time (sec)</label>
        <input type="number" [(ngModel)]="part.time">
      </div>

      <div class="form-item" *ngIf="!part.timeBased">
        <label>Count</label>
        <input type="number" [(ngModel)]="part.count">
      </div>

      <div class="form-item" *ngIf="isType('mantra')">
        <label>Type</label>
        <select [(ngModel)]="part.name" (change)="mantraTypeChanged()">
          <option [value]="t.name" *ngFor="let t of mantraTypes">{{ t.name }}</option>
        </select>
      </div>

      <div class="form-item" *ngIf="isType('metronome') || isType('mantra')">
        <label>Length (sec)</label>
        <input type="number" [(ngModel)]="part.sliceLength">
      </div>

      <div class="form-item" *ngIf="isType('heart beat')">
        <label>Heart beat rate (bpm, [30, 150])</label>
        <input type="number" [(ngModel)]="part.value1">
      </div>

      @if (isType('mantra')) {
        <div class="form-item">
          <label>Space (sec)</label>
          <input type="number" [(ngModel)]="part.sliceSpace">
        </div>

        <div class="form-item">
          <label>Group size</label>
          <input type="number" [(ngModel)]="part.mantraGroup">
        </div>
        @if (part.mantraGroup > 1) {
          <div class="form-item">
            <label>Group space (sec)</label>
            <input type="number" [(ngModel)]="part.mantraGroupSpace">
          </div>
        }
      }

      @if (isType('polyphonic binaural beats')) {
        <div class="form-item">
          <label>Description (max. 3 threads)</label>
          <textarea type="text" [(ngModel)]="part.valueStr"></textarea>
        </div>
        <div class="form-item">
          <p>Format: </p>
          <p class="code-block">T1[A1-A2-V1|B1-B2-V2|...],T2[C1-C2-V3|...],...</p>
          <p>Where:</p>
          <p class="code-block">T1, T2 ... duration in seconds</p>
          <p class="code-block">A1, B1 ... frequency for left ear in Hz</p>
          <p class="code-block">A2, B2 ... frequency for right ear in Hz</p>
          <p class="code-block">V1, V2 ... volume level: L (low), M (medium), H (high)</p>
          <p>Example:</p>
          <p class="code-block">5[450-458-L],10[450-458-L|300-305-M]</p>
        </div>
      }

      @if (isType('binaural beats')) {
        <div class="form-item">
          <label>Base (L) frequency (Hz, [50, 1000])</label>
          <input type="number" [(ngModel)]="part.value1">
        </div>
        <div class="form-item">
          <label>Start diff (Hz, [0, 100])</label>
          <input type="number" [(ngModel)]="part.value2">
        </div>
        <div class="form-item">
          <label>End diff (Hz, [0, 100])</label>
          <input type="number" [(ngModel)]="part.value3">
        </div>
        <div class="form-item">
          <label>Interpolation mode</label>
          <select [(ngModel)]="part.name">
            <option [value]="mode" *ngFor="let mode of interpolations">{{ mode }}</option>
          </select>
        </div>
      }
    </div>
    <div class="footer flex-center">
      <div class="button flex-center primary" (click)="save()"><img src="./assets/images/ok.png" alt=""></div>
      <div class="button flex-center" (click)="cancel()"><img src="./assets/images/cancel.png" alt=""></div>
    </div>
  </div>
  <div class="backdrop"></div>
</div>